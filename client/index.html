<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TaskFlow Pro - Synergy Tasks</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Optional visual libraries (placeholders for future enhancements) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js" defer></script>

  <!-- Splide carousel (not used yet but kept for design parity) -->
  <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js" defer></script>
  <link href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="/src/styles.css" />
</head>
<body class="min-h-screen bg-slate-50 text-slate-800">
  <div id="p5-background" class="fixed inset-0 -z-10 opacity-30"></div>

  <!-- Navigation -->
  <nav class="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-4">
          <div class="flex items-center space-x-2">
            <div class="w-9 h-9 bg-gradient-to-br from-blue-500 to-teal-500 rounded-lg flex items-center justify-center text-white font-semibold">
              ST
            </div>
            <div>
              <p class="text-lg font-semibold text-slate-900 leading-tight">TaskFlow Pro</p>
              <p class="text-xs text-slate-500">Synergy Tasks workspace</p>
            </div>
          </div>
          <ul id="viewList" class="flex flex-wrap items-center gap-2 ml-6 mt-4 md:mt-0 md:gap-2">
            <li>
              <button class="view-pill active" data-view="workspace" aria-pressed="true">
                Workspace
                <span class="count-pill" data-count="workspace">0</span>
              </button>
            </li>
            <li>
              <button class="view-pill" data-view="today" aria-pressed="false">
                Due Today
                <span class="count-pill" data-count="today">0</span>
              </button>
            </li>
            <li>
              <button class="view-pill" data-view="upcoming" aria-pressed="false">
                Upcoming 7 Days
                <span class="count-pill" data-count="upcoming">0</span>
              </button>
            </li>
          </ul>
          <div class="hidden md:flex items-center space-x-4 ml-6">
            <button type="button" class="text-sm font-medium text-slate-500 hover:text-slate-900 transition" data-action="open-userguide" aria-controls="userguidePanel">
              Userguide
            </button>
            <a href="settings.html" class="text-sm font-medium text-slate-500 hover:text-slate-900 transition">Settings</a>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <div class="relative" data-search-root>
            <label class="relative block">
              <span class="sr-only">Search tasks</span>
              <input id="searchInput" type="search" placeholder="Search tasks" class="peer search-input" />
              <span class="search-icon">
                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-4.35-4.35M18 10.5a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Z"></path>
                </svg>
              </span>
            </label>
            <div id="searchResults" class="search-suggestions" hidden></div>
          </div>
          <button id="exportTasks" class="nav-icon-btn" title="Export tasks">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m4 16 4 4 4-4m-4 4V4m7 4h4a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-4"></path>
            </svg>
          </button>
          <button class="nav-icon-btn md:hidden" type="button" data-action="open-userguide" aria-controls="userguidePanel" aria-label="Open userguide">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M9.09 9a3 3 0 1 1 5.82 1.5c-.54 1.06-1.59 1.49-1.91 2.5-.08.27-.1.52-.1 1" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <section id="userguidePanel" class="userguide-panel" hidden aria-live="polite">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="userguide-card">
        <header class="userguide-card__header">
          <div>
            <p class="text-sm font-semibold uppercase tracking-wide text-slate-500">Userguide</p>
            <h2 class="text-2xl font-semibold text-slate-900 leading-tight">How to stay organised</h2>
            <p class="text-sm text-slate-500">Simple steps anyone on the team can follow.</p>
          </div>
          <div class="userguide-actions">
            <button type="button" class="ghost-button small" data-action="edit-userguide">Edit guide</button>
            <button type="button" class="ghost-button small" data-action="close-userguide">Close</button>
          </div>
        </header>
        <ol id="userguideList" class="userguide-list"></ol>
        <form id="userguideForm" class="userguide-form" hidden>
          <label class="field-label" for="userguideEditor">Update the steps (one per line)</label>
          <textarea id="userguideEditor" rows="6" class="field-input" placeholder="Add step per line"></textarea>
          <div class="userguide-form__actions">
            <button type="button" class="btn-secondary" data-action="cancel-userguide">Cancel</button>
            <button type="submit" class="btn-primary">Save guide</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Hero -->
  <section class="relative overflow-hidden bg-gradient-to-br from-blue-500 to-teal-500 py-12 text-white">
    <div class="absolute inset-0 opacity-10 bg-[url('https://images.unsplash.com/photo-1545239351-1141bd82e8a6?auto=format&fit=crop&w=1600&q=80')] bg-cover bg-center"></div>
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center max-w-3xl mx-auto">
      </div>
      <div class="max-w-3xl mx-auto mt-10">
        <div class="glass-card flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div>
            <p class="text-sm uppercase tracking-wide text-white/70 mb-1">Active tasks</p>
            <p class="text-4xl font-semibold" id="active-tasks">0</p>
          </div>
          <label class="flex items-center gap-2 text-sm font-medium text-white/80">
            <span>View</span>
            <select id="metricFilter" class="rounded-full border border-white/40 bg-white/15 px-3 py-2 text-slate-900 font-medium focus:outline-none focus:ring-2 focus:ring-white/60">
              <option value="all">All active tasks</option>
              <option value="critical">Critical priority</option>
              <option value="very-high">Very high priority</option>
              <option value="high">High priority</option>
              <option value="medium">Medium priority</option>
              <option value="low">Low priority</option>
              <option value="optional">Optional priority</option>
              <option value="completed">Completed tasks</option>
            </select>
          </label>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
      <!-- Workspace column -->
      <section class="lg:col-span-3 space-y-6">
        <!-- Project tabs and controls -->
        <div class="bg-white border border-slate-200 rounded-2xl shadow-sm">
          <div class="px-6 py-5 border-b border-slate-100 flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
            <div>
              <h2 class="text-xl font-semibold text-slate-900">Workspace</h2>
              <p class="text-sm text-slate-500" id="viewSubtitle">All unscheduled tasks live here.</p>
            </div>
            <div class="flex items-center flex-wrap gap-2">
              <div class="inline-flex rounded-full border border-slate-200 bg-slate-50/80 p-1" role="toolbar" aria-label="View mode">
                <button class="toggle-pill active" data-view-mode="list" aria-pressed="true">List</button>
                <button class="toggle-pill" data-view-mode="board" aria-pressed="false">Board</button>
              </div>
              <button id="toggleQuickAdd" class="btn-primary" type="button">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path>
                </svg>
                Add Task
              </button>
            </div>
          </div>

          <div class="px-6 py-4 border-b border-slate-100 space-y-4">
            <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
              <div class="flex flex-col gap-3 w-full">
                <div class="flex flex-col gap-3">
                  <div class="selector-group">
                    <div class="flex flex-wrap items-center justify-between gap-2">
                      <span class="selector-label">Company</span>
                      <button type="button" class="chip-button" data-action="add-company">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path>
                        </svg>
                        New company
                      </button>
                    </div>
                    <div id="companyTabs" class="tab-strip" role="tablist"></div>
                    <p id="companyTabsEmpty" class="text-xs text-slate-500 mt-2" hidden>Add your first company.</p>
                  </div>
                  <div class="selector-group">
                    <span class="selector-label">Project</span>
                    <div class="selector-dropdown" data-dropdown="project">
                      <button id="projectDropdownToggle" class="selector-toggle" type="button" aria-haspopup="true" aria-expanded="false">
                        <span id="projectDropdownLabel">Select project</span>
                        <svg class="w-4 h-4" viewBox="0 0 20 20" fill="none" aria-hidden="true">
                          <path d="M5 8l5 5 5-5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                      </button>
                      <div id="projectDropdownMenu" class="selector-menu" role="menu" hidden>
                        <div class="selector-menu-actions">
                          <button type="button" class="chip-button w-full justify-center" data-action="add-project-inline">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path>
                            </svg>
                            New project
                          </button>
                        </div>
                        <ul id="projectDropdownList" class="selector-list" role="listbox"></ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex flex-wrap gap-2">
                <button id="addProject" class="chip-button">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path>
                  </svg>
                  Add Project
                </button>
                <button id="importWhatsapp" class="chip-button">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 1 1 0-8h10a4 4 0 1 1 0 8H7Zm5-8v12"></path>
                  </svg>
                  Import WhatsApp
                </button>
              </div>
            </div>

            <form id="quickAddForm" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 quick-add-card hidden" novalidate>
              <div class="sm:col-span-2 lg:col-span-2 xl:col-span-3">
                <label class="field-label">Title</label>
                <input type="text" name="title" placeholder="Launch planning sync" maxlength="160" required class="field-input" />
                <small class="text-xs text-rose-500" data-error-for="title"></small>
              </div>
              <div class="sm:col-span-2 lg:col-span-2 xl:col-span-3">
                <label class="field-label">Description</label>
                <textarea name="description" rows="1" placeholder="Context, blockers, next steps" class="field-input"></textarea>
              </div>
              <div>
                <label class="field-label">Due</label>
                <input type="date" name="dueDate" class="field-input" />
              </div>
              <div>
                <label class="field-label">Priority</label>
                <select name="priority" class="field-input">
                  <option value="critical">Critical</option>
                  <option value="very-high">Very high</option>
                  <option value="high">High</option>
                  <option value="medium" selected>Medium</option>
                  <option value="low">Low</option>
                  <option value="optional">Optional</option>
                </select>
              </div>
              <div>
                <label class="field-label">Project</label>
                <select name="project" class="field-input"></select>
              </div>
              <div>
                <label class="field-label">Section</label>
                <select name="section" class="field-input"></select>
              </div>
              <div>
                <label class="field-label">Department</label>
                <select name="department" class="field-input"></select>
              </div>
              <div>
                <label class="field-label">Member</label>
                <select name="assignee" class="field-input"></select>
              </div>
              <div class="sm:col-span-2 lg:col-span-3 xl:col-span-3">
                <label class="field-label">Attachments</label>
                <input type="file" name="attachments" multiple class="field-input" />
                <ul class="attachment-list" data-attachment-list></ul>
              </div>
              <div class="sm:col-span-2 lg:col-span-3 xl:col-span-6 flex justify-end items-center gap-3">
                <p class="quick-add-error flex-1 text-sm text-rose-500" role="alert"></p>
                <button type="button" class="btn-secondary" data-action="cancel">Cancel</button>
                <button type="submit" class="btn-primary">Add task</button>
              </div>
            </form>
          </div>
        </div>

        <div id="sectionActions" class="flex justify-end" hidden>
          <button id="addSection" class="chip-button">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path>
            </svg>
            Add section
          </button>
        </div>

        <section id="boardView" class="space-y-4" hidden>
          <div id="boardColumns" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4" role="list"></div>
          <p id="boardEmptyState" class="empty-state" hidden>Switch to a project to start using the board view.</p>
        </section>

        <section id="listView" class="space-y-6">
          <div class="bg-white border border-slate-200 rounded-2xl shadow-sm">
            <div class="px-6 py-4 border-b border-slate-100 flex flex-wrap items-center justify-between gap-3">
              <h3 class="text-base font-semibold text-slate-900" id="viewTitle">Inbox</h3>
              <div id="taskTabList" class="tab-strip tab-strip--compact" role="tablist" aria-label="Task filter tabs"></div>
            </div>
            <div class="px-6 py-5 space-y-5">
              <div id="taskTabPanels" class="space-y-5" aria-live="polite"></div>
            </div>
          </div>
        </section>
      </section>

      <!-- Sidebar -->
      <aside class="space-y-6">
        <div class="bg-white border border-slate-200 rounded-2xl shadow-sm p-5">
          <h4 class="text-sm font-semibold uppercase tracking-wide text-slate-500 mb-4">Recent activity</h4>
          <div id="activity-feed" class="space-y-3 text-sm text-slate-600"></div>
        </div>
      </aside>
    </div>
  </main>

  <!-- Task dialog -->
  <dialog id="taskDialog" class="modal">
    <form id="dialogForm" method="dialog" class="modal-card">
      <header class="modal-header">
        <h2 class="text-lg font-semibold text-slate-900">Edit task</h2>
        <button type="button" class="ghost-button small" data-action="close">Close</button>
      </header>
      <div class="modal-body space-y-4">
        <label class="form-field">
          <span class="field-label">Title</span>
          <input type="text" name="title" required maxlength="160" class="field-input" />
        </label>
        <label class="form-field">
          <span class="field-label">Description</span>
          <textarea name="description" rows="4" class="field-input"></textarea>
        </label>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Due date</span>
            <input type="date" name="dueDate" class="field-input" />
          </label>
          <label class="form-field">
            <span class="field-label">Priority</span>
            <select name="priority" class="field-input">
              <option value="critical">Critical</option>
              <option value="very-high">Very high</option>
              <option value="high">High</option>
              <option value="medium">Medium</option>
              <option value="low">Low</option>
              <option value="optional">Optional</option>
            </select>
          </label>
        </div>
        <label class="form-field">
          <span class="field-label">Section</span>
          <select name="section" class="field-input"></select>
        </label>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Department</span>
            <select name="department" class="field-input"></select>
          </label>
          <label class="form-field">
            <span class="field-label">Member</span>
            <select name="assignee" class="field-input"></select>
          </label>
        </div>
        <label class="form-field">
          <span class="field-label">Attachments</span>
          <input type="file" name="attachments" multiple class="field-input" />
        </label>
        <ul class="attachment-list" data-dialog-attachment-list></ul>
        <label class="form-field">
          <span class="field-label">Project</span>
          <select name="project" class="field-input"></select>
        </label>
        <label class="checkbox-field">
          <input type="checkbox" name="completed" />
          <span>Mark as completed</span>
        </label>
      </div>
      <footer class="modal-footer">
        <button class="ghost-button danger" data-action="delete" type="button">Delete</button>
        <button class="btn-primary" type="submit">Save changes</button>
      </footer>
    </form>
  </dialog>

  <!-- Task item template -->
  <template id="taskItemTemplate">
    <li class="task-item task-card">
      <label class="task-checkbox">
        <input type="checkbox" aria-label="Mark task complete" />
        <span class="checkbox-indicator" aria-hidden="true"></span>
      </label>
      <div class="task-content">
        <p class="task-title text-slate-900 font-medium"></p>
        <p class="task-meta text-sm text-slate-500 flex flex-wrap gap-2"></p>
      </div>
      <div class="task-actions flex items-center gap-2">
        <button type="button" class="chip-button" data-action="edit">Edit</button>
      </div>
    </li>
  </template>

  <!-- Company dialog -->
  <dialog id="companyDialog" class="modal">
    <form id="companyForm" method="dialog" class="modal-card max-w-md" novalidate>
      <header class="modal-header">
        <h2 class="text-lg font-semibold text-slate-900">Edit company</h2>
        <button type="button" class="ghost-button small" data-action="close-company">Close</button>
      </header>
      <div class="modal-body space-y-4">
        <label class="form-field">
          <span class="field-label">Company name</span>
          <input id="companyName" name="companyName" type="text" placeholder="Company name" required class="field-input" />
        </label>
        <p class="text-xs text-slate-500" data-company-subtitle hidden></p>
        <p class="form-error" data-company-error></p>
      </div>
      <footer class="modal-footer justify-between">
        <button type="button" class="ghost-button danger" data-action="delete-company">Delete company</button>
        <div class="flex gap-2">
          <button type="button" class="ghost-button" data-action="close-company">Cancel</button>
          <button type="submit" class="btn-primary">Save changes</button>
        </div>
      </footer>
    </form>
  </dialog>

  <!-- Meeting dialog -->
  <dialog id="meetingDialog" class="modal">
    <form id="meetingForm" method="dialog" class="modal-card max-w-2xl" novalidate>
      <header class="modal-header">
        <h2 class="text-lg font-semibold text-slate-900">Log meeting</h2>
        <button type="button" class="ghost-button small" data-action="close-meeting">Close</button>
      </header>
      <div class="modal-body space-y-4">
        <p class="text-sm text-slate-500" data-meeting-project></p>
        <input type="hidden" name="projectId" />
        <label class="form-field">
          <span class="field-label">Title</span>
          <input type="text" name="title" required class="field-input" placeholder="Sprint planning sync" />
        </label>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Date</span>
            <input type="date" name="date" class="field-input" />
          </label>
          <label class="form-field">
            <span class="field-label">Priority</span>
            <select name="priority" class="field-input">
              <option value="critical">Critical</option>
              <option value="very-high">Very high</option>
              <option value="high">High</option>
              <option value="medium" selected>Medium</option>
              <option value="low">Low</option>
              <option value="optional">Optional</option>
            </select>
          </label>
        </div>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Department</span>
            <select name="department" class="field-input"></select>
          </label>
          <label class="form-field">
            <span class="field-label">Meeting type</span>
            <select name="meetingType" class="field-input">
              <option value="">Select type</option>
              <option>Google Meet</option>
              <option>Teams</option>
              <option>Zoom</option>
              <option>In Person</option>
            </select>
          </label>
        </div>
        <label class="form-field">
          <span class="field-label">Attendees</span>
          <textarea name="attendees" rows="2" class="field-input" placeholder="Alex, Jamie, product squad"></textarea>
        </label>
        <label class="checkbox-field">
          <input type="checkbox" name="actionItems" />
          <span>Action items captured</span>
        </label>
        <label class="form-field">
          <span class="field-label">Notes</span>
          <textarea name="notes" rows="3" class="field-input" placeholder="Agenda, context and decisions"></textarea>
        </label>
        <div class="field-group">
          <div class="flex items-center justify-between">
            <span class="field-label">Links</span>
            <button type="button" class="ghost-button small" data-action="meeting-add-link">Add link</button>
          </div>
          <ul class="link-list" data-meeting-links></ul>
        </div>
        <p class="form-error" data-meeting-error></p>
      </div>
      <footer class="modal-footer">
        <button type="button" class="ghost-button" data-action="close-meeting">Cancel</button>
        <button type="submit" class="btn-primary">Save meeting</button>
      </footer>
    </form>
  </dialog>

  <!-- Email dialog -->
  <dialog id="emailDialog" class="modal">
    <form id="emailForm" method="dialog" class="modal-card max-w-2xl" novalidate>
      <header class="modal-header">
        <h2 class="text-lg font-semibold text-slate-900">Log email</h2>
        <button type="button" class="ghost-button small" data-action="close-email">Close</button>
      </header>
      <div class="modal-body space-y-4">
        <p class="text-sm text-slate-500" data-email-project></p>
        <input type="hidden" name="projectId" />
        <label class="form-field">
          <span class="field-label">Title</span>
          <input type="text" name="title" required class="field-input" placeholder="Client follow-up" />
        </label>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Date</span>
            <input type="date" name="date" class="field-input" />
          </label>
          <label class="form-field">
            <span class="field-label">Priority</span>
            <select name="priority" class="field-input">
              <option value="critical">Critical</option>
              <option value="very-high">Very high</option>
              <option value="high">High</option>
              <option value="medium" selected>Medium</option>
              <option value="low">Low</option>
              <option value="optional">Optional</option>
            </select>
          </label>
        </div>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Department</span>
            <select name="department" class="field-input"></select>
          </label>
          <label class="form-field">
            <span class="field-label">Status</span>
            <select name="status" class="field-input">
              <option value="Pending">Pending</option>
              <option value="Completed">Completed</option>
              <option value="In Progress">In Progress</option>
              <option value="Updates">Updates</option>
            </select>
          </label>
        </div>
        <label class="form-field">
          <span class="field-label">Email address</span>
          <input type="email" name="emailAddress" class="field-input" placeholder="team@company.com" />
        </label>
        <label class="form-field">
          <span class="field-label">Notes</span>
          <textarea name="notes" rows="3" class="field-input" placeholder="Summary, next steps, context"></textarea>
        </label>
        <div class="field-group">
          <div class="flex items-center justify-between">
            <span class="field-label">Links</span>
            <button type="button" class="ghost-button small" data-action="email-add-link">Add link</button>
          </div>
          <ul class="link-list" data-email-links></ul>
        </div>
        <p class="form-error" data-email-error></p>
      </div>
      <footer class="modal-footer">
        <button type="button" class="ghost-button" data-action="close-email">Cancel</button>
        <button type="submit" class="btn-primary">Save email</button>
      </footer>
    </form>
  </dialog>

  <!-- WhatsApp import dialog -->
  <dialog id="whatsappDialog" class="modal">
    <form id="whatsappForm" method="dialog" class="modal-card max-w-2xl">
      <header class="modal-header">
        <h2 class="text-lg font-semibold text-slate-900">Import WhatsApp action items</h2>
        <button type="button" class="ghost-button small" data-action="cancel-whatsapp">Close</button>
      </header>
      <div class="modal-body space-y-4">
        <p class="text-sm text-slate-600">
          Upload a WhatsApp chat export (<code>.zip</code> or <code>.txt</code>). Only the last 30 days are processed,
          and messages older than the last import are skipped automatically.
        </p>
        <label class="form-field">
          <span class="field-label">Chat export</span>
          <input id="whatsappFile" type="file" name="whatsappFile" accept=".zip,.txt" required class="field-input" />
          <small class="text-xs text-slate-500">Exports without media work best. Media text will be supported later.</small>
        </label>
        <div class="form-row">
          <label class="form-field">
            <span class="field-label">Gemini model</span>
            <select id="whatsappModel" class="field-input">
              <option value="gemini-1.5-flash">gemini-1.5-flash (default)</option>
              <option value="gemini-1.5-flash-latest">gemini-1.5-flash-latest</option>
              <option value="gemini-1.5-flash-002">gemini-1.5-flash-002</option>
              <option value="gemini-1.5-flash-001">gemini-1.5-flash-001</option>
              <option value="gemini-1.5-pro">gemini-1.5-pro</option>
              <option value="gemini-1.0-pro">gemini-1.0-pro</option>
            </select>
          </label>
          <label class="form-field">
            <span class="field-label">API endpoint</span>
            <select id="whatsappEndpoint" class="field-input">
              <option value="v1">v1 (stable)</option>
              <option value="v1beta">v1beta (fallback)</option>
            </select>
          </label>
        </div>
        <div id="whatsappPreview" class="import-preview" hidden>
          <p class="text-sm text-slate-600">
            <strong data-whatsapp-file></strong>
            <span class="text-slate-400">&middot;</span>
            <span data-whatsapp-range></span>
          </p>
          <ul class="import-summary" data-whatsapp-summary></ul>
        </div>
        <p id="whatsappError" class="text-sm text-rose-500" hidden></p>
      </div>
      <footer class="modal-footer">
        <button type="button" class="ghost-button" data-action="cancel-whatsapp">Cancel</button>
        <button type="submit" class="btn-primary" data-action="submit-whatsapp">Fetch action items</button>
      </footer>
    </form>
  </dialog>

  <script type="module" src="/src/main.js"></script>
</body>
</html>



